<div>
  <app-symbol-search
      label="{{null}}"
      placeholder="Search for securities using ticker or name"
      (tickerSelected)="onTickerSelected($event)"
      cssClass="form-control">
  </app-symbol-search>
</div>

<div *ngIf="loaded">

  <div>
    <div class="row" *ngIf="openOptions.length > 0 || owned.length > 0">
      <div class="col text-center">
        <div class="font-weight-bold text-muted">STOCKS</div>
        <div><b>{{moneySpentOnShares | currency}}</b> invested</div>
        <div><b>{{currentEquity | currency}}</b> current equity</div>
        <div [ngClass]="{'profits-positive': profits > 0, 'profits-negative': profits < 0}">{{profits | percent }}</div>
      </div>
      <div class="col text-center">
        <div class="font-weight-bold text-muted">OPTIONS</div>
        <div>{{putContracts}} PUTs and {{callContracts}} CALLs</div>
        <div>
          <b>{{putCollateral | currency}}</b>
          collateral held
        </div>
        <div><b>{{optionPremium | currency}}</b> premium ({{putPremiumvsCollateralPct | percent }} collateral coverage)</div>
    </div>
  </div>

  <div class="mt-4" *ngIf="openOptions.length > 0 || owned.length > 0">

    <!-- <div class="row border rounded" *ngFor="let option of openOptions">
      <div class="col-2 text-center">
        <div><a class="font-weight-bold" [routerLink]="[ '/optiondetails', option.id ]">{{option.ticker}}</a></div>
        <div>{{option.currentPrice | currency}}</div>
      </div>
      <div class="col-10">

      </div>
    </div> -->

    <table class="table">
      <thead>
        <tr>
          <th>Symbol</th>
          <th>Share Price</th>
          <th></th>
          <th class="text-right">Gain/Loss</th>
          <th class="text-right">%</th>
        </tr>
      </thead>
      <tr *ngFor="let option of openOptions">
        <td><a [routerLink]="[ '/optiondetails', option.id ]">{{option.ticker}}</a></td>
        <td class="text-right">{{option.currentPrice | currency}}</td>
        <td><b>{{option.numberOfContracts}}</b> x {{option.boughtOrSold}}
          <b>{{option.strikePrice | currency}}</b>
          {{option.optionType}} expiring
          <b>{{option.expirationDate | date : 'shortDate'}}</b>
          <span *ngIf="option.expiresSoon" class="ml-1 badge badge-warning">expires soon</span>
          <span *ngIf="option.isExpired" class="ml-1 badge badge-danger">expired</span>
        </td>
        <td colspan="2"></td>
      </tr>
      <tr *ngFor="let ticker of owned">
        <td><a [routerLink]="[ '/stocks', ticker.ticker ]">{{ticker.ticker}}</a></td>
        <td class="text-right">{{ticker.currentPrice | currency}}</td>
        <td>{{ticker.owned}}</td>
        <td class="text-right"><span class="col text-right" [ngClass]="{'profits-positive': ticker.profits > 0, 'profits-negative': ticker.profits < 0}">{{ticker.profits | currency }}</span></td>
        <td class="text-right"><span class="col text-right" [ngClass]="{'profits-positive': ticker.profits > 0, 'profits-negative': ticker.profits < 0}">{{ticker.profitsPct | percent }}</span></td>
      </tr>
    </table>

  <div *ngIf="openOptions.length == 0 && owned.length == 0">
    <div class="alert alert-secondary">
      You haven't recorded any option/share transactions.
    </div>
  </div>

</div>

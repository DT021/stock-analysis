<h2>Your Review</h2>

<div *ngIf="!loaded">
  Generating your report, this might take a while, please wait
  <div class="spinner-border text-info spinner-border-sm" role="status">
    <span class="sr-only">Loading...</span>
  </div>
</div>

<div *ngIf="result && result.transactions.transactions.length > 0">

  <div class="card mt-2 mb-3">
    <div class="card-header">
      <span class="font-weight-bold">Transaction Summary</span>
      from <b>{{ result.start | date }}</b> to <b>{{ result.end | date}}</b>
      <span class="float-right">({{ result.transactions.transactions.length}} transactions)</span>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col">
          <span class="font-weight-bold">{{result.transactions.debit | currency}}</span> debit
        </div>
        <div class="col text-right">
          <span class="font-weight-bold">{{result.transactions.credit | currency}}</span> credit
        </div>
      </div>
    </div>

    <div class="card-footer">
      Balance: <span class="font-weight-bold">{{ result.transactions.credit - result.transactions.debit | currency }}</span>
    </div>
  </div>

  <div class="mt-2">
    <table class="table table-hover border rounded">
      <thead class="thead-light">
        <tr>
          <th width="100">Date</th>
          <th width="100">Symbol</th>
          <th>Description</th>
          <th width="125" class="text-right">Debit</th>
          <th width="125" class="text-right">Credit</th>
        </tr>
      </thead>
      <tbody>
        <tr
          *ngFor="let t of result.transactions.transactions">
          <td>{{ t.date | date:'shortDate'}}</td>
          <td><a [routerLink]="[ '/stocks', t.ticker ]" target="_blank">{{t.ticker}}</a></td>
          <td>{{ t.description }}</td>
          <td class="text-right">{{ t.debit | currency }}</td>
          <td class="text-right">{{ t.credit | currency }}</td>
        </tr>
      </tbody>
      <tfoot>
        <tr class="table-secondary">
          <td>Totals</td>
          <td></td>
          <td></td>
          <td class="text-right">{{result.transactions.debit | currency}}</td>
          <td class="text-right">{{result.transactions.credit | currency}}</td>
        </tr>
      </tfoot>
    </table>
  </div>

</div>

<div *ngIf="result && result.entries.length > 0">
  <div class="card mb-3" *ngFor="let e of result.entries">
    <div class="card-body">
      <h5 class="card-title">
        {{e.ticker}}
        <span class="float-right">{{e.price.amount | currency}}</span>
      </h5>

      <div *ngIf="e.expiresIn && e.expiresIn > 0" class="alert alert-success">
        Expires in {{e.expiresIn}} days.
      </div>

      <p style="white-space: pre-wrap;" class="card-text" *ngFor="let d of e.descriptions">
        {{d}}
      </p>

      <h6 *ngIf="e.notes.length > 0">Notes</h6>
      <p style="white-space: pre-wrap;" class="card-text" *ngFor="let n of e.notes" >
        <span class="bg-info rounded text-white p-1 m-1">{{n.date | date }}</span>
        <span class="bg-secondary rounded text-white p-1 m-1" *ngIf="n.price && n.price.amount > 0">{{n.price.amount | currency }}</span>

        {{n.text}}
      </p>
    </div>
  </div>
</div>
